<app-banner></app-banner>

<div class="page-container" *ngIf="globalVars.inTab || globalVars.webview || globalVars.callback">
  <!-- Step 1 -->
  <!-- Generate seed phrase. -->
  <div *ngIf="stepScreen === SignUpComponent.STEP_GENERATE_SEED">
    <div class="step-row">
      <div class="title-text">Store your DeSo seed phrase</div>
      <div class="step-title">Step 1 of {{ stepTotal }}</div>
    </div>
    <div class="subtitle-text">Write, download, print, or copy it somewhere safe.</div>
    <div class="warning-text">If you lose your DeSo seed phrase your account will be lost forever.</div>
    <div class="seed-phrase-container">
      <div *ngIf="!entropyService.advancedOpen" class="px-25px pt-10px pb-30px border-bottom">{{
        entropyService.temporaryEntropy.mnemonic }}
      </div>
      <div class="fc-red px-15px pt-15px" *ngIf="!entropyService.advancedOpen && hasEntropyError()">
        Please fix errors in your advanced entropy configuration.
      </div>
      <div class="fc-red px-15px pt-15px"
           *ngIf="!entropyService.advancedOpen && !hasEntropyError() && entropyService.temporaryEntropy.extraText.length > 0">
        Note that you have added a passphrase in the advanced menu.
      </div>
      <div class=" py-20px px-25px seed-actions-row">
        <div class="d-flex align-items-center">
          <button (click)="stepOneCopy()" class="seed-phrase-button d-flex align-items-center">
            <img *ngIf="seedCopied" src="assets/check-square.svg" width="16px" height="16px" class="mr-5px"/>
            <img *ngIf="!seedCopied" src="assets/copy.svg" class="mr-5px"/>
            <span>Copy</span>
          </button>
          <button (click)="stepOneDownload()" class="seed-phrase-button d-flex align-items-center ml-10px">
            <img src="assets/download.svg" class="mr-5px"/>
            <span>Download</span>
          </button>
          <button (click)="stepOnePrint()" class="seed-phrase-button d-flex align-items-center ml-10px">
            <img src="assets/print.svg" class="mr-5px"/>
            <span>Print</span>
          </button>
        </div>
        <div class="fc-blue fs-16px cursor-pointer toggle-advanced" *ngIf="!entropyService.advancedOpen"
             (click)="entropyService.advancedOpen = true">Advanced
        </div>
        <div class="fc-blue fs-16px cursor-pointer toggle-advanced" *ngIf="entropyService.advancedOpen"
             (click)="entropyService.advancedOpen = false">Simple
        </div>
      </div>
      <div class="border-top border-color-grey" *ngIf="entropyService.advancedOpen">
        <div class="w-100 py-25px px-30px">
          <div class="fs-15px fc-default">
            <p>
              The following displays the entropy (random numbers) used to generate the "DeSo seed phrase" above.
              The entropy below was generated using a random number generator, but you can edit the
              fields below to use your own randomness to generate the DeSo seed phrase (you can't go wrong
              with a set of dice). You can also enter your own DeSo seed phrase directly if you prefer.
            </p>

            <p class="pt-15px">
              Because there is a standard for generating seed phrases for Bitcoin (called
              <a target="_blank" href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP39</a>),
              and because we use this same standard to generate DeSo seed phrases,
              DeSo seed phrases can also be used with any Bitcoin wallet that implements
              this standard under the m/44'/0'/0'/0/0 derivation path (e.g.
              <a target="_blank" href="https://wallet.mycelium.com/">Mycelium</a>,
              <a target="_blank" href="https://electrum.org">Electrum</a>).
              Similarly, any standard
              Bitcoin seed phrase you have can also be used as a DeSo seed phrase. Of course, all
              of this can be verified using a tool like the
              <a target="_blank" href="https://iancoleman.io/bip39/">Ian Coleman mnemonic generator</a>
              (must click "show entropy details") so you know this generator is doing what it says it is.
            </p>
          </div>

          <div style="margin-top: 55px">
            <p class="title-text-small">Custom DeSo seed phrase (must be
              <a target="_blank" href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP39</a>
              mnemonic):</p>
            <p class="fc-red font-weight-normal fs-16px py-10px" *ngIf="showMnemonicError">You've entered an invalid
              mnemonic.</p>
            <div class="text-input-container-light mt-10px">
              <textarea [(ngModel)]="entropyService.temporaryEntropy.mnemonic"
                        (ngModelChange)="checkMnemonic()"
                        class="text-input"
                        style="resize: none; height: 70px"
                        rows="2"></textarea>
            </div>
          </div>

          <div class="mt-25px">
            <p class="title-text-small">Passphrase:</p>
            <div class="text-input-container-light mt-10px">
              <textarea [(ngModel)]="entropyService.temporaryEntropy.extraText"
                        (ngModelChange)="normalizeExtraText()"
                        class="text-input"
                        style="resize: none; height: 70px"
                        rows="2"></textarea>
            </div>
          </div>

          <div class="mt-25px">
            <p class="title-text-small">Custom Entropy (hex = base16 = [0-9a-f]):</p>
            <p class="fc-red font-weight-normal fs-16px py-10px" *ngIf="showEntropyHexError">
              Entropy value must be a hexadecimal value with a total number of characters
              that is a multiple of 8, less than 128, and greater than 32.</p>
            <div class="text-input-container-light mt-10px">
              <textarea [(ngModel)]="entropyService.temporaryEntropy.customEntropyHex"
                        (ngModelChange)="checkEntropyHex()"
                        class="text-input"
                        style="resize: none; height: 70px"
                        rows="2"></textarea>
            </div>
          </div>

          <button (click)="getNewEntropy()" class="button button-small button-secondary mt-20px" style="height: 54px">
            Regenerate
          </button>
        </div>
      </div>
    </div>
    <div class="d-flex pt-15px justify-content-end">
      <button *ngIf="!hasEntropyError()"
              (click)="stepOneNext()"
              class="button button-primary button-small">
        Next
      </button>
      <button *ngIf="hasEntropyError()"
              (click)="stepOneNext()"
              class="button button-primary-disabled button-small" disabled>
        Next
      </button>
    </div>

    <!--Spacer (for mobile)-->
    <!-- If the "create a post" blue circle is showing, it will overlap the "Next" button. Adding space-->
    <!-- down here gives the user enough space to scroll down to reveal the next button.-->
    <!-- This works for now, but we should do something better long term, e.g. hide the blue circle
    on this page.-->
    <div style="padding-bottom: 85px"></div>
  </div>

  <!-- Step 2 -->
  <!-- Verify seed phrase. -->
  <div *ngIf="stepScreen === SignUpComponent.STEP_VERIFY_SEED">
    <div class="step-row">
      <div class="title-text">Verify your DeSo seed phrase</div>
      <div class="step-title">Step 2 of {{ stepTotal }}</div>
    </div>
    <div class="subtitle-text">Never share your DeSo seed phrase with anyone.</div>
    <div class="warning-text"><b>If you lose your DeSo seed phrase your account will be lost forever.</b></div>
    <div class="text-input-container mt-25px">
      <textarea [(ngModel)]="mnemonicCheck"
                class="text-input"
                rows="4"
                placeholder="Enter your DeSo seed phrase"></textarea>
    </div>
    <div class="title-text-small pt-15px mb-20px" *ngIf="entropyService.temporaryEntropy.extraText.length > 0">
      Enter your passphrase:
    </div>
    <div class="text-input-container pt-10px" *ngIf="entropyService.temporaryEntropy.extraText.length > 0">
      <textarea [(ngModel)]="extraTextCheck"
                class="text-input"
                rows="4"
                placeholder="Enter your passphrase"></textarea>
    </div>
    <div class="d-flex align-items-center" style="margin-top: -15px">
      <div class="fs-18px mt-15px fc-default font-weight-normal">
        By proceeding, you agree to the
        <a (click)="clickTos()" class="font-weight-bold cursor-pointer">Terms of Service</a>.
      </div>
    </div>
    <div class="d-flex pt-15px justify-content-between">
      <button (click)="stepTwoBack()"
              class="button button-small button-secondary">
        Back
      </button>
      <div>
        <button *ngIf="entropyService.temporaryEntropy.mnemonic == mnemonicCheck
                       && entropyService.temporaryEntropy.extraText == extraTextCheck"
                (click)="stepTwoNext()"
                class="button button-small button-primary">
          Next
        </button>
        <button *ngIf="entropyService.temporaryEntropy.mnemonic != mnemonicCheck
                       || entropyService.temporaryEntropy.extraText != extraTextCheck"
                class="button button-small button-primary-disabled" disabled>
          Next
        </button>
      </div>
    </div>

    <!--Spacer (for mobile)-->
    <!-- If the "create a post" blue circle is showing, it will overlap the "Next" button. Adding space-->
    <!-- down here gives the user enough space to scroll down to reveal the next button.-->
    <!-- This works for now, but we should do something better long term, e.g. hide the blue circle
    on this page.-->
    <div style="padding-bottom: 85px"></div>
  </div>

  <!-- Step 3 -->
  <!-- Get Starter $DESO. -->
  <div *ngIf="stepScreen === SignUpComponent.STEP_GET_STARTER_DESO">
    <div class="w-100 text-center fs-32px font-weight-bold">Get Starter $DESO</div>
    <div class="w-100 text-center mt-20px fs-20px font-weight-bold">
      Validate your phone number or buy your first $DESO.
    </div>
    <div class="w-100 d-flex align-items-center flex-column">
      <div style="max-width: 500px" class="w-100 text-center fs-18px mt-5px mb-30px text-muted fc-secondary">
        This is the cryptocurrency that fuels the DeSo blockchain and allows you to invest in creators & buy NFTs.
      </div>
      <div class="w-100 text-center fs-18px mt-20px mb-10px font-weight-bold mb-10px">Choose an option</div>
      <button
        (click)="stepThreeNextPhone()"
        [ngStyle]="{ 'width': '40%', 'min-width': '300px' }"
        class="styled-primary-button mb-10px"
      >
        Get $DESO with Phone Number
      </button>
      <div class="fs-16px fc-muted">To earn under $1</div>
      <button
        (click)="stepThreeNextBuy()"
        [ngStyle]="{ 'width': '40%', 'min-width': '300px' }"
        class="styled-secondary-button mt-30px mb-10px"
      >
        Buy or Send $DESO Anonymously
      </button>
      <div class="fs-16px fc-muted">Transfer from an exchange or a DeSo account</div>
    </div>
  </div>

  <div *ngIf="stepScreen === SignUpComponent.STEP_VERIFY_PHONE_NUMBER">
    <sign-up-get-starter-deso
      [displayForSignupFlow]="true"
      [publicKey]="publicKeyAdded"
      [skipAppBanner]="true"
      [finishFlowEventOnly]="true"
      (phoneNumberVerified)="phoneNumberVerified()"
      (finishFlowEvent)="finishFlowPhoneNumber()"
      (skipButtonClicked)="finishFlowPhoneNumberSkip()"
    ></sign-up-get-starter-deso>
  </div>

  <div *ngIf="stepScreen === SignUpComponent.STEP_OBTAIN_DESO">
    <!--    <div class="modal-header">-->
    <!--      <div *ngIf="showModal" class="modal-header-x" (click)="bsModalRef.hide()">-->
    <!--        <i-feather name="x"></i-feather>-->
    <!--      </div>-->
    <!--    </div>-->
    <div class="onboarding-buy-deso-container p-16px">
      <div class="fs-20px fc-muted pb-10px mb-10px">Easily transfer $DESO or purchase some directly</div>
      <div class="border-bottom w-100 mb-30px"></div>
      <div class="d-flex mb-30px">
        <div class="d-flex align-items-center flex-column fc-blue">
          <div
            style="border-color: #005BFF"
            class="d-flex align-items-center justify-content-center fs-20px onboarding-info-bar-circle mb-10px"
          >
            A
          </div>
        </div>
        <div class="ml-20px w-100">
          <div class="fs-20px fc-default font-weight-bold mb-16px">Don't have any $DESO? We make it easy to buy.</div>
          <div class="p-30px mb-20px bg-light br-10px d-flex flex-column align-items-center">
            <div class="fc-default font-weight-bold fs-18px mb-20px text-center">Buy DESO with ETH, BTC, fiat, or on
              Coinbase
            </div>
            <div class="d-flex justify-content-around">
              <div class="col-10 d-flex align-items-center flex-column">
                <!--                (click)="openBuyDeSoModal(true)"-->
                <button class="styled-primary-button mb-16px" style="width: 200px">Buy Now!</button>
                <div class="fs-12px fc-muted text-center">We support 20 fiat currencies including USD and more.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="border-bottom w-100 mb-30px"></div>
      <div class="d-flex">
        <div class="d-flex align-items-center flex-column fc-blue">
          <div
            style="border-color: #005BFF"
            class="d-flex align-items-center justify-content-center fs-20px onboarding-info-bar-circle mb-10px"
          >
            B
          </div>
        </div>
        <div class="ml-20px">
          <div class="fs-20px fc-default font-weight-bold mb-16px">Transfer $DESO to your new account</div>
          <div class="fs-16px fc-muted mb-30px">You will need at least 0.01 $DESO to create your new account. This could
            be transferred from an exchange like Coinbase, or from another account on a DeSo app like Diamond.
          </div>
          <div class="fs-18px fc-default font-weight-semibold mb-10px">Send $DESO to this address</div>
          <div
            class="w-100 bg-light p-10px br-10px cursor-pointer mb-10px"
          >
            <div
              class="fs-16px font-weight-normal fc-default mb-10px mt-5px text-center"
            >
              {{ publicKeyAdded }}
            </div>
            <div class="w-100 border-bottom"></div>
            <div class="d-flex justify-content-around mt-10px mb-5px" (click)="_copyPublicKey()">
              <span>
<!--                <i-feather-->
<!--                  *ngIf="publicKeyIsCopied"-->
<!--                  class="feather-small check-indicator position-relative"-->
<!--                  name="check-circle"-->
<!--                ></i-feather>-->
<!--                <i-feather-->
<!--                  *ngIf="!publicKeyIsCopied"-->
<!--                  class="feather-small copy-button cursor-pointer position-relative"-->
<!--                  name="copy"-->
<!--                ></i-feather>-->
                <span class="fs-16px fc-blue ml-5px">Click to Copy</span>
              </span>
            </div>
          </div>
          <div class="d-flex mb-25px">
            <div class="fc-default fs-16px mr-5px font-weight-semibold">Your current balance</div>
            <div class="fs-16px fc-muted d-flex align-items-center">
              <div>{{ globalVars.nanosToDeSo(userBalanceNanos) }} $DESO</div>

              <div *ngIf="!refreshBalanceCooldown">
                <div (click)="refreshBalance()" class="ml-10px d-flex align-items-center cursor-pointer">
                  <div class="d-flex">
<!--                    <i-feather class="fc-default feather-small fs-0px mr-5px" name="refresh-cw"></i-feather>-->
                  </div>
                  <span class="fc-blue">Refresh</span>
                </div>
              </div>
              <div *ngIf="refreshBalanceCooldown">
                <div class="ml-10px">
                  <span class="fc-muted">Refresh in {{refreshBalanceRetryTime}}s</span>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="userBalanceNanos > 0" class="d-flex align-items-center flex-column">
            <button (click)="finishFlowTransferDeSo()" class="styled-secondary-button">Finish</button>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
