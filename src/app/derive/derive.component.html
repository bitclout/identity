<app-banner></app-banner>

<div
  *ngIf="!globalVars.callbackInvalid && !deleteKey"
  class="container home-container text-center d-flex flex-column"
>
  <div>
    <div class="title-text">
      Grant signing access
      <span *ngIf="!globalVars.callback">to {{ globalVars.hostname }}</span>
    </div>

    <div class="d-flex flex-column" *ngIf="hasUsers && !isSingleAccount">
      <ul
        class="list-group mt-7px mb-30px saved-seeds-list saved-seeds-scroll"
        style="max-height: 700px"
      >
        <span class="saved-seeds-header d-flex align-items-center"
          ><span>Select an account</span></span
        >
        <li
          *ngFor="let item of allUsers | keyvalue; let i = index"
          class="list-group-item list-group-item-action cursor-pointer saved-seed"
          [ngClass]="{ selectedKey: publicKeyBase58Check === item.key }"
          (click)="publicKeyBase58Check = item.key"
        >
          <div class="w-100 d-flex justify-content-between">
            <div *ngIf="!item.value.username" class="text-left">
              <div class="my-1">
                <img
                  class="avatar mr-15px"
                  src="assets/placeholder-account-image.png"
                />
                {{ truncatePublicKey(item.key) }}
              </div>
            </div>
            <div *ngIf="item.value.username" class="d-flex align-items-center">
              <div class="avatar mr-15px" [appAvatar]="item.key"></div>
              <div class="">{{ item.value.username }}</div>
            </div>
          </div>
          <!-- <a
            class="link fs-18px"
            *ngIf="i === hoveredAccount && !isSingleAccount"
            type="button"
            (click)="approveDerivedKey(item.key)"
          >
            Approve
          </a> -->
        </li>
      </ul>
    </div>
    <div
      class="fs-18px pt-15px pb-5px"
      style="overflow: hidden; overflow-wrap: anywhere; word-break: break-all"
      *ngIf="derivedPublicKeyBase58Check"
    >
      <div class="pl-20px text-left d-flex justify-content-between">
        Public Key
        <span class="font-weight-normal pr-20px pb-15px text-left">{{
          truncatePublicKey(publicKeyBase58Check)
        }}</span>
      </div>
      <div class="pl-20px text-left d-flex justify-content-between">
        Derived Public Key
        <span class="font-weight-normal pr-20px">{{
          truncatePublicKey(derivedPublicKeyBase58Check)
        }}</span>
      </div>
    </div>
  </div>
  <div *ngIf="transactionSpendingLimitResponse" class="mb-40px">
    <app-transaction-spending-limit
      [transactionSpendingLimitResponse]="transactionSpendingLimitResponse"
    ></app-transaction-spending-limit>
  </div>
  <div></div>
  <button
    [disabled]="!publicKeyBase58Check"
    class="button btn-primary button-large mb-20px text-white font-weight-bold"
    (click)="approveDerivedKey(publicKeyBase58Check)"
  >
    Approve
  </button>

  <div class="container home-container" *ngIf="deleteKey">
    <div>
      <div class="fs-18px mt-30px">
        <span class="fs-underline"
          ><b
            >You're about to revoke signing access for a Derived Public Key</b
          ></span
        ><br />
        This means <b>{{ derivedPublicKeyBase58Check }}</b> will no longer be
        able to make transactions on your behalf.
      </div>
    </div>
  </div>
</div>
<div *ngIf="globalVars.callbackInvalid">
  <app-error-callback></app-error-callback>
</div>
