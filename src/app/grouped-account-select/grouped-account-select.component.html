<div class="section--accounts" *ngIf="hasVisibleAccounts">
  <div class="section--accounts__header margin-bottom--medium">
    Select an account
  </div>

  <ng-container
    *ngFor="let group of accountGroups | keyvalue : keyValueSort; let i = index"
  >
    <div *ngIf="group.value.accounts.length" class="margin-bottom--large">
      <ul
        class="section--accounts__list container--scrollbar margin-bottom--small"
      >
        <li
          *ngFor="let account of group.value.accounts; let j = index"
          data-control-name="account-select-item"
        >
          <div class="display--flex items--center margin-top--small">
            <button
              class="section--accounts__item margin-right--small"
              (click)="selectAccount(account.publicKey)"
              role="button"
            >
              <div class="display--flex items--center">
                <img
                  class="avatar--rounded avatar--large margin-right--small"
                  [appAvatar]="account.publicKey"
                />
                <div>
                  <div>
                    <span [title]="getAccountDisplayName(account)">{{
                      getAccountDisplayName(account) | truncateAddressOrUsername
                    }}</span>
                    <span
                      *ngIf="account.lastUsed && !this.globalVars.isMobile()"
                      class="font-size--xsmall text--green-lighter margin-left--small"
                      >Last used</span
                    >
                  </div>
                  <div *ngIf="this.globalVars.isMobile()" class="display--flex">
                    <span class="font-size--xsmall"
                      >Account: {{ account.accountNumber }}</span
                    >
                    <span
                      *ngIf="account.lastUsed"
                      class="font-size--xsmall text--green-lighter margin-left--auto"
                      >Last used</span
                    >
                  </div>
                </div>
              </div>
              <div class="display--flex items--center">
                <div
                  *ngIf="!this.globalVars.isMobile()"
                  class="display--flex flex--column items--end"
                >
                  <span
                    class="font-weight--bold font-size--xsmall margin-right--small"
                    >{{
                      globalVars.abbreviateNumber(account.balanceNanos / 1e9)
                    }}
                    $DESO</span
                  >
                  <span class="font-size--xsmall margin-right--small"
                    >Account: {{ account.accountNumber }}</span
                  >
                </div>
                <img
                  [src]="
                    getLoginMethodIcon(
                      accountService.getLoginMethodWithPublicKeyBase58Check(
                        group.key
                      )
                    )
                  "
                  class="section--accounts__icon"
                />
              </div>
            </button>
            <button
              *ngIf="!isMetaMaskAccountGroup(group.key)"
              class="styleless-button"
              (click)="hideAccount(group.key, account)"
            >
              <i-feather name="power" class="text--blue-base"></i-feather>
            </button>
          </div>
        </li>
      </ul>
      <div *ngIf="!isMetaMaskAccountGroup(group.key)">
        <div class="display--flex">
          <button
            *ngIf="shouldShowExportSeedButton(group.key)"
            class="button--small button--red display--flex items--center margin-right--small"
            style="width: auto; white-space: nowrap"
            (click)="exportSeed(group.key)"
          >
            <i-feather
              name="save"
              class="margin-right--xsmall"
              style="height: 16px; width: 16px"
            />
            Backup
          </button>
          <button
            class="button--small button--primary display--flex items--center margin-right--small"
            style="width: auto; white-space: nowrap"
            aria-label="Add account"
            (click)="addSubAccount(group.key)"
          >
            <i-feather
              name="user-plus"
              class="margin-right--xsmall"
              style="height: 16px; width: 16px"
            />
            Account
          </button>
          <button
            class="button--small button--secondary display--flex items--center"
            style="width: auto; white-space: nowrap"
            (click)="toggleRecoverSubAccountForm(group.key)"
          >
            <i-feather
              name="power"
              class="margin-right--xsmall"
              style="height: 16px; width: 16px"
            />
            Recover
          </button>
        </div>
        <form
          *ngIf="group.value.showRecoverSubAccountInput"
          (submit)="recoverSubAccount($event, group.key)"
          class="margin-top--small margin-left--small"
        >
          <label for="account-number" class="display--block font-size--small"
            >Enter account number:</label
          >
          <input
            [(ngModel)]="accountNumberToRecover"
            name="account-number"
            id="account-number"
            type="number"
            step="1"
          />
          <button
            type="submit"
            class="button--primary button--small margin-left--small"
            style="width: auto; white-space: nowrap"
          >
            Submit
          </button>
        </form>
      </div>
    </div>
    <div class="text--divider margin-top--medium margin-bottom--medium">or</div>
  </ng-container>
</div>
<app-log-in-options></app-log-in-options>
